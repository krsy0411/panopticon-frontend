# Panopticon Features Guide

이 문서는 Panopticon 프론트엔드의 주요 기능과 사용 방법을 설명합니다.

---

## 목차

1. [대시보드](#1-대시보드)
2. [서비스 목록](#2-서비스-목록)
3. [서비스 상세](#3-서비스-상세)
4. [트레이스 분석](#4-트레이스-분석)
5. [SLO 알림 설정](#5-slo-알림-설정)
6. [에이전트 설치 가이드](#6-에이전트-설치-가이드)

---

## 1. 대시보드

### 개요

대시보드는 모든 서비스의 상태를 한눈에 파악할 수 있는 메인 화면입니다.

### 주요 기능

#### 1.1 위젯 시스템

- **드래그 앤 드롭**: 위젯을 원하는 위치로 자유롭게 배치
- **위젯 종류**:
  - 서비스 상태 카드
  - 요약 메트릭 차트
  - 에러 로그 리스트
  - SLO 상태 인디케이터

#### 1.2 시간 범위 선택

| 옵션   | 설명                 |
| ------ | -------------------- |
| 15분   | 최근 15분간의 데이터 |
| 1시간  | 최근 1시간 데이터    |
| 6시간  | 최근 6시간 데이터    |
| 24시간 | 최근 24시간 데이터   |
| 7일    | 최근 7일 데이터      |

시간 범위를 변경하면 모든 차트와 메트릭이 해당 기간의 데이터로 자동 갱신됩니다.

### 사용 흐름

```
대시보드 접속 → 서비스 상태 확인 → 이상 징후 발견 시 서비스 클릭 → 상세 페이지 이동
```

---

## 2. 서비스 목록

### 개요

등록된 모든 서비스를 카드 형태로 표시하는 페이지입니다.

### 표시 정보

각 서비스 카드에는 다음 정보가 표시됩니다:

| 항목              | 설명                             |
| ----------------- | -------------------------------- |
| **서비스명**      | 등록된 서비스의 이름             |
| **총 요청 수**    | 선택된 시간 범위 내 총 요청 횟수 |
| **에러율**        | 전체 요청 중 에러 비율 (%)       |
| **평균 레이턴시** | 요청 처리 평균 소요 시간 (ms)    |

### 상태 인디케이터

서비스 카드는 상태에 따라 색상이 변합니다:

- **녹색**: 정상 (에러율 < 1%)
- **노란색**: 주의 (에러율 1~5%)
- **빨간색**: 위험 (에러율 > 5%)

---

## 3. 서비스 상세

### 개요

특정 서비스의 상세 메트릭과 엔드포인트 정보를 확인하는 페이지입니다.

### 3.1 메트릭 차트

#### 차트 종류

| 차트                    | 설명                               |
| ----------------------- | ---------------------------------- |
| **요청수 (Requests)**   | 시간대별 요청 횟수 추이            |
| **에러율 (Error Rate)** | 시간대별 에러 발생 비율            |
| **레이턴시 (Latency)**  | 시간대별 응답 시간 (p50, p95, p99) |

#### 차트 레이아웃

차트 버튼을 클릭하여 레이아웃을 변경할 수 있습니다:

- **기본**: 3개 차트 나란히 표시
- **1개 선택**: 선택한 차트를 크게 표시
- **2개 선택**: 선택한 차트 2개를 나란히 표시

#### 인터랙션

- **차트 클릭**: 해당 시간대의 트레이스 목록을 조회하는 패널이 열림
- **범례 클릭**: 특정 시리즈 표시/숨기기
- **줌**: 마우스 드래그로 특정 구간 확대

### 3.2 엔드포인트 테이블

서비스의 모든 엔드포인트에 대한 성능 정보를 테이블로 표시합니다.

| 컬럼        | 설명                                    |
| ----------- | --------------------------------------- |
| **메서드**  | HTTP 메서드 (GET, POST, PUT, DELETE 등) |
| **경로**    | API 엔드포인트 경로                     |
| **요청 수** | 해당 엔드포인트의 총 요청 수            |
| **에러율**  | 에러 비율                               |
| **P50**     | 응답 시간의 50번째 백분위수             |
| **P95**     | 응답 시간의 95번째 백분위수             |
| **P99**     | 응답 시간의 99번째 백분위수             |

### 3.3 실시간 에러 로그

WebSocket을 통해 실시간으로 에러 로그를 수신하여 표시합니다.

**표시 정보**:

- 발생 시간
- 에러 메시지
- 스택 트레이스
- 관련 트레이스 ID

**클릭 시**: 해당 에러와 연관된 트레이스 분석 화면으로 이동

---

## 4. 트레이스 분석

### 개요

분산 시스템에서 요청이 어떤 서비스들을 거쳐 처리되는지 시각화합니다.

### 4.1 분석 뷰 종류

#### Waterfall View (기본)

시간 순서대로 각 스팬(Span)을 폭포수 형태로 표시합니다.

**특징**:

- 각 스팬의 시작 시간과 소요 시간을 시각적으로 표현
- 부모-자식 관계를 들여쓰기로 표현
- 각 스팬 클릭 시 상세 정보 표시

**활용**:

- 어느 구간에서 지연이 발생했는지 파악
- 비동기 호출의 병렬 처리 확인

#### Flame Graph View

호출 스택을 화염 그래프 형태로 시각화합니다.

**특징**:

- X축: 전체 시간 중 차지하는 비율
- Y축: 호출 깊이 (스택)
- 색상: 서비스별 구분

**활용**:

- CPU 시간을 많이 소비하는 구간 식별
- 깊은 호출 체인 발견

#### Map View

서비스 간의 호출 관계를 노드-엣지 그래프로 표시합니다.

**특징**:

- 노드: 각 서비스
- 엣지: 서비스 간 호출 관계
- 엣지 두께: 호출 빈도

**활용**:

- 서비스 의존성 파악
- 순환 호출 발견

#### Span List View

모든 스팬 정보를 테이블 형태로 표시합니다.

| 컬럼          | 설명                             |
| ------------- | -------------------------------- |
| **서비스**    | 스팬이 발생한 서비스명           |
| **작업**      | 스팬 이름 (API 호출, DB 쿼리 등) |
| **소요 시간** | 해당 스팬의 처리 시간            |
| **상태**      | 성공/실패 여부                   |

### 4.2 스팬 상세 정보

스팬을 클릭하면 다음 정보를 확인할 수 있습니다:

- **기본 정보**: 서비스명, 작업명, 소요 시간
- **태그**: HTTP 상태 코드, URL, 메서드 등
- **이벤트**: 스팬 내 발생한 이벤트 로그
- **에러 정보**: 에러 발생 시 스택 트레이스

---

## 5. SLO 알림 설정

### 개요

Service Level Objective(SLO)를 정의하고, 임계치를 초과하면 자동으로 알림을 발송합니다.

### 5.1 SLO 생성

#### 지원 메트릭

| 메트릭         | 설명           | 예시                    |
| -------------- | -------------- | ----------------------- |
| **Error Rate** | 에러 발생 비율 | 1% 초과 시 알림         |
| **Latency**    | 응답 시간      | P99 > 500ms 시 알림     |
| **Throughput** | 처리량         | 분당 100건 미만 시 알림 |

#### 설정 항목

1. **서비스 선택**: SLO를 적용할 서비스
2. **메트릭 타입**: Error Rate / Latency / Throughput
3. **임계치**: 알림을 발송할 기준값
4. **알림 채널**: 웹훅 연동

### 5.2 알림 채널 설정

#### 지원 채널

##### Slack

```
Webhook URL: https://hooks.slack.com/services/...
```

- Slack 워크스페이스의 Incoming Webhook URL 입력
- 메시지 포맷: 서비스명, 메트릭, 현재값, 임계치

##### Discord

```
Webhook URL: https://discord.com/api/webhooks/...
```

- Discord 채널의 Webhook URL 입력
- Embed 형태로 알림 발송

##### Microsoft Teams

```
Webhook URL: https://outlook.office.com/webhook/...
```

- Teams 채널의 Incoming Webhook URL 입력
- Adaptive Card 형태로 알림 발송

##### Email

```
수신자: admin@example.com
```

- 알림을 받을 이메일 주소 입력
- 여러 수신자 지정 가능

### 5.3 SLO 카드

설정된 SLO는 카드 형태로 표시됩니다:

- **상태 인디케이터**: 현재 SLO 충족 여부
- **현재값**: 실시간 메트릭 값
- **임계치**: 설정된 기준값
- **연결된 웹훅**: 알림 채널 목록

---

## 6. 에이전트 설치 가이드

### 개요

서비스에 APM 에이전트를 설치하는 단계별 가이드를 제공합니다.

### 6.1 설치 단계

#### Step 1: 에이전트 다운로드

제공되는 설치 스크립트 또는 패키지를 다운로드합니다.

#### Step 2: 환경 설정

```bash
export PANOPTICON_API_KEY=your-api-key
export PANOPTICON_SERVICE_NAME=your-service-name
export PANOPTICON_ENDPOINT=https://collector.panopticon.io
```

#### Step 3: 에이전트 시작

애플리케이션과 함께 에이전트를 시작합니다.

#### Step 4: 연결 확인

대시보드에서 서비스가 등록되었는지 확인합니다.

### 6.2 UI 컴포넌트

설치 가이드 페이지는 다음 컴포넌트로 구성됩니다:

| 컴포넌트              | 역할                  |
| --------------------- | --------------------- |
| **StepIndicator**     | 현재 진행 단계 표시   |
| **StepHeader**        | 단계 제목 및 설명     |
| **CopyableCodeBlock** | 복사 가능한 코드 블록 |
| **StepChecklist**     | 완료 체크리스트       |

### 6.3 체크리스트

설치 완료 후 확인 사항:

- [ ] 에이전트가 정상적으로 시작되었는가
- [ ] API 키가 올바르게 설정되었는가
- [ ] Collector 엔드포인트에 연결되었는가
- [ ] 대시보드에 서비스가 표시되는가
- [ ] 메트릭 데이터가 수집되고 있는가

---

## 부록: 키보드 단축키

| 단축키 | 동작           |
| ------ | -------------- |
| `Esc`  | 모달/패널 닫기 |

---

## 부록: 용어 사전

| 용어            | 설명                                        |
| --------------- | ------------------------------------------- |
| **APM**         | Application Performance Monitoring          |
| **SLO**         | Service Level Objective - 서비스 수준 목표  |
| **Trace**       | 요청이 시스템을 통과하는 전체 경로          |
| **Span**        | Trace를 구성하는 개별 작업 단위             |
| **P50/P95/P99** | 백분위수 - 응답 시간 분포의 50/95/99번째 값 |
| **Webhook**     | HTTP 콜백을 통한 알림 전달 방식             |
